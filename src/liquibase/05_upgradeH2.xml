<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd">
    <changeSet author="niels" id="1350468477768-1a" >
        <renameColumn tableName="SCHUELER" oldColumnName="GESCHLECHT" newColumnName="GESCHLECHT_CHAR"/>
     </changeSet>
     <changeSet author="niels" id="1350468477768-1b" >
        <addColumn tableName="SCHUELER">
            <column name="GESCHLECHT" type="INT"/>
        </addColumn>
        <addNotNullConstraint tableName="SCHUELER" columnName="GESCHLECHT" columnDataType="INT"  defaultNullValue="2"/>
     </changeSet>
     <changeSet author="niels" id="1350468477768-1c" >
        <comment>Umstellung auf Ordinal bei Enums, vorher sprechender Buchstabe.</comment>
        <sql>update SCHUELER set GESCHLECHT = '0' where GESCHLECHT_CHAR='m'</sql>
        <sql>update SCHUELER set GESCHLECHT = '1' where GESCHLECHT_CHAR='w'</sql>
        <dropColumn tableName="SCHUELER" columnName="GESCHLECHT_CHAR"/>
    </changeSet>
    <changeSet author="niels (generated)" id="1350468477768-2">
        <modifyDataType columnName="AUSGABE_DATUM" newDataType="DATE" tableName="ZEUGNIS_FORMULAR"/>
    </changeSet>
    <changeSet author="niels (generated)" id="1350468477768-3">
        <modifyDataType columnName="NACHTEILS_AUSGLEICHS_DATUM" newDataType="DATE" tableName="ZEUGNIS_FORMULAR"/>
    </changeSet>
        <changeSet author="niels (generated)" id="1350468477768-11">
        <dropIndex indexName="UK_SCHULFACH_TYP_NAME" tableName="SCHULFACH"/>
    </changeSet>
    <changeSet author="niels (generated)" id="1350468477768-12">
        <createIndex indexName="UK_SCHULFACH_TYP_NAME" tableName="SCHULFACH" unique="true">
            <column name="TYP"/>
            <column name="NAME"/>
        </createIndex>
    </changeSet>
    <changeSet author="niels (generated)" id="1350468477768-13">
        <dropIndex indexName="UK_SCHULAHLBJAHR_JAHR_HALBJAHR" tableName="SCHULHALBJAHR"/>
    </changeSet>
    <changeSet author="niels (generated)" id="1350468477768-14">
        <createIndex indexName="UK_SCHULAHLBJAHR_JAHR_HALBJAHR" tableName="SCHULHALBJAHR" unique="true">
            <column name="JAHR"/>
            <column name="HALBJAHR"/>
        </createIndex>
    </changeSet>
    <changeSet author="niels (generated)" id="1350468477768-17">
        <dropTable tableName="ENCRYPTED_DATA"/>
    </changeSet>

     <changeSet author="niels" id="1350468477768-18s" >
        <comment>Umstellung auf Ordinal bei Enums</comment>
        <sql>update av_sv_bewertung set beurteilung = beurteilung - 1</sql>
        <sql>update arbeits_und_sozial_verhalten set typ = typ - 1</sql>
        <sql>update schulhalbjahr set halbjahr = halbjahr - 1</sql>
        <sql>update schulfach set typ = typ - 1</sql>
    </changeSet>
</databaseChangeLog>
